<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智汇办 - Coze Chat</title>
    
    <style>
        /* 这里整合了 main.css 的内容 */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            /* 建议加上 overflow: hidden 防止出现不必要的滚动条，因为聊天窗口是悬浮层 */
            overflow: hidden; 
            background-color: #f5f7fa; /* 稍微加个背景色，这样聊天窗口弹出来更明显 */
        }
    </style>
</head>
<body>
    
    <!-- 1. 加载 Coze Chat SDK -->
    <!-- 注意：这个 SDK 版本 (chat-app-sdk) 主要用于生成悬浮/弹窗式的聊天应用 -->
    <script src="https://lf-cdn.coze.cn/obj/unpkg/flow-platform/chat-app-sdk/1.2.0-beta.19/libs/cn/index.js"></script>

    <!-- 2. 初始化逻辑 -->
    <script>
        // 等待页面加载完成后执行，确保 SDK 已经就绪
        window.addEventListener('load', function() {
            
            // 初始化 Chat SDK 并保存实例到变量
            const cozeWebSDK = new CozeWebSDK.WebChatClient({
                config: {
                    type: 'app',
                    bot_id: '', // 在 type='app' 模式下，主要依赖 appInfo
                    isIframe: false,
                    appInfo: {
                        appId: '7578837631745097754',
                        workflowId: '7578919509240463398'    
                    },
                },
                auth: {
                    type: 'token',
                    // 注意：在生产环境中，Token 建议通过后端接口动态获取，不要直接写死在前端
                    token: 'sat_2pVMi67LibNtzgKM2JGhjSAxRfJQycPBHWKYeUm7HwRkJPrRt1O3dp33lsKVYM7J',
                    onRefreshToken: async () => 'sat_2pVMi67LibNtzgKM2JGhjSAxRfJQycPBHWKYeUm7HwRkJPrRt1O3dp33lsKVYM7J'
                },
                userInfo: {
                    id: 'user',
                    url: 'https://lf-coze-web-cdn.coze.cn/obj/eden-cn/lm-lgvj/ljhwZthlaukjlkulzlp/coze/coze-logo.png',
                    nickname: 'User',
                },
                ui: {
                    base: {
                        icon: 'https://lf-coze-web-cdn.coze.cn/obj/eden-cn/lm-lgvj/ljhwZthlaukjlkulzlp/coze/chatsdk-logo.png',
                        layout: 'pc', // PC 布局模式
                        lang: 'zh-CN',
                        zIndex: 1000
                    },
                    header: {
                        isShow: true,
                        isNeedClose: false, // 禁止关闭，保证窗口一直存在
                    },
                    asstBtn: {
                        isNeed: false // 隐藏右下角的悬浮球，因为我们要强制弹出
                    },
                    footer: {
                        isShow: true,
                        expressionText: 'Powered by Doubao-1.5-pro-32k',
                    },
                    conversations: {
                        isNeed: true,
                    },
                    chatBot: {
                        title: '智汇办',
                        uploadable: true,
                        width: 400,
                        isNeedAudio: false,
                        isNeedQuote: true,
                        feedback: {
                            isNeedFeedback: false,
                            feedbackPanel: {
                                tags: [
                                    {
                                        label: '内容有误',
                                        isNeedDetail: false,
                                    },
                                ],
                            },
                        },
                    },
                },
            });

            // 3. 初始化后立即显示聊天窗口
            // 因为隐藏了悬浮球 (asstBtn: false)，这一步是必须的，否则用户看不到界面
            cozeWebSDK.showChatBot();
        });
    </script>
</body>
</html>
